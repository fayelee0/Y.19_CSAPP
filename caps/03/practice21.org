#+AUTHOR: Fei Li
#+EMAIL: wizard@pursuetao.com
* Practice 21

  #+BEGIN_SRC c

  long test(long x, long y)
  {
      long val = ;
      if () {
          if () {
              val = ;
          } else {
              val = ;
          }
      } else if () {
          val = ;
      }
      return val;
  }
  
  #+END_SRC


  #+BEGIN_SRC asm
  
  ; long test(long x, long y)
  ; x in %rdi, y in %rsi
  test:
    leaq    0(,%rdi,8),%rax   ; val = x * 8
    testq   %rsi,%rsi         ; y:y
    jle     .L2               ; y <= 0 jump .L2
    movq    %rsi,%rax         ; val = y
    subq    %rdi,%rax         ; val = y - x
    movq    %rdi,%rdx         ; vale = x
    andq    %rsi,%rdx         ; vale = x & y
    cmpq    %rsi,%rdi         ; x:y
    cmovge  %rdx,%rax         ; if (x >= y) val = vale
    ret
  .L2:
    addq    %rsi,%rdi         ; t = x + y
    cmpq    $-2,%rsi          ; y:-2
    cmovle  %rdi,%rax         ; if (y <= -2) val = t
    ret
  
  #+END_SRC


  #+BEGIN_SRC c

  long test(long x, long y)
  {
      long val = x * 8;
      if (y > 0) {
          if (x < y) {
              val = y - x;
          } else {
              val = x & y;
          }
      } else if (y <= -2) {
          val = x + y;
      }
      return val;
  }
  
  #+END_SRC
